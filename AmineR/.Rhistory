'acviteprjeb1697_homolog_ensembl_peptide',
'anceylprjna72583_homolog_ensembl_peptide',
'assuumprjna62057_homolog_ensembl_peptide',
'brmalaprjna10729_homolog_ensembl_peptide',
'brpahaprjeb497_homolog_ensembl_peptide',
'brtimoprjeb4663_homolog_ensembl_peptide',
'buxyloprjea64437_homolog_ensembl_peptide',
'caelegprjna13758_homolog_ensembl_peptide',
'diimmiprjeb1797_homolog_ensembl_peptide',
'drmediprjeb500_homolog_ensembl_peptide',
'elelapprjeb502_homolog_ensembl_peptide',
'hacontprjeb506_homolog_ensembl_peptide',
'hepolyprjeb15396_homolog_ensembl_peptide',
'lisigmprjeb3075_homolog_ensembl_peptide',
'loloaprjna246086_homolog_ensembl_peptide',
'neamerprjna72135_homolog_ensembl_peptide',
'onflexprjna230512_homolog_ensembl_peptide',
'onocheprjeb1204_homolog_ensembl_peptide',
'onvolvprjeb513_homolog_ensembl_peptide',
'parediprjna186477_homolog_ensembl_peptide',
'paunivprjna386823_homolog_ensembl_peptide',
'patricprjeb515_homolog_ensembl_peptide',
'prpaciprjna12644_homolog_ensembl_peptide',
'stcarpprjna202318_homolog_ensembl_peptide',
'strattprjeb125_homolog_ensembl_peptide',
'tocaniprjna248777_homolog_ensembl_peptide',
'trspirprjna12603_homolog_ensembl_peptide',
'trmuriprjeb126_homolog_ensembl_peptide',
'wubancprjna275548_homolog_ensembl_peptide'
)
# pull the desired data
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
all_orthologs <- bind_rows(orthologs, orthologs2) %>%
arrange(transcript_id) %>%
distinct()
View(all_orthologs)
View(orthologs2)
rm(all_orthologs)
View(orthologs2)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = 'wbps_paralog_paralog_peptide_id') %>%
janitor::clean_names() %>%
dplyr::select(transcript_id = 1) %>%
distinct() %>%
arrange(transcript_id)
View(paralogs)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct()
View(final_list)
View(orthologs2)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct()
library(tidyverse)
library(here)
library(conflicted)
library(biomaRt)
conflict_prefer("filter", "dplyr")
# Get orthologes of C. elegans AmineRs ------------------------------------
seeds <- read_csv(here('AmineR', 'aux', 'celegans_aminer.txt'), col_names = 'seed')
# establish the BioMart that will be used
mart <- useMart("parasite_mart", dataset = "wbps_gene", host = "https://parasite.wormbase.org", port = 443)
# set parameters
filters = c('wbps_gene_id')
value = list(seeds$seed)
attributes = c('wbps_peptide_id',
'acviteprjeb1697_homolog_ensembl_peptide',
'anceylprjna72583_homolog_ensembl_peptide',
'assuumprjna62057_homolog_ensembl_peptide',
'brmalaprjna10729_homolog_ensembl_peptide',
'brpahaprjeb497_homolog_ensembl_peptide',
'brtimoprjeb4663_homolog_ensembl_peptide',
'buxyloprjea64437_homolog_ensembl_peptide',
'caelegprjna13758_homolog_ensembl_peptide',
'diimmiprjeb1797_homolog_ensembl_peptide',
'drmediprjeb500_homolog_ensembl_peptide',
'elelapprjeb502_homolog_ensembl_peptide',
'hacontprjeb506_homolog_ensembl_peptide',
'hepolyprjeb15396_homolog_ensembl_peptide',
'lisigmprjeb3075_homolog_ensembl_peptide',
'loloaprjna246086_homolog_ensembl_peptide',
'neamerprjna72135_homolog_ensembl_peptide',
'onflexprjna230512_homolog_ensembl_peptide',
'onocheprjeb1204_homolog_ensembl_peptide',
'onvolvprjeb513_homolog_ensembl_peptide',
'parediprjna186477_homolog_ensembl_peptide',
'paunivprjna386823_homolog_ensembl_peptide',
'patricprjeb515_homolog_ensembl_peptide',
'prpaciprjna12644_homolog_ensembl_peptide',
'stcarpprjna202318_homolog_ensembl_peptide',
'strattprjeb125_homolog_ensembl_peptide',
'tocaniprjna248777_homolog_ensembl_peptide',
'trspirprjna12603_homolog_ensembl_peptide',
'trmuriprjeb126_homolog_ensembl_peptide',
'wubancprjna275548_homolog_ensembl_peptide'
)
# pull the desired data
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = 'wbps_paralog_paralog_peptide_id') %>%
janitor::clean_names() %>%
dplyr::select(transcript_id = 1) %>%
distinct() %>%
arrange(transcript_id)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct()
write_csv(final_list,
"~/Box/ZamanianLab/Data/Genomics/AmineR/identification_pipeline/3/all_amineR.txt",
col_names = FALSE)
View(final_list)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct() %>%
mutate(transcript_id = str_remove(transcript_id, '\.[0-9]$'))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct() %>%
mutate(transcript_id = str_remove(transcript_id, '/.[0-9]$'))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct() %>%
mutate(transcript_id = str_remove(transcript_id, '\\.[0-9]$'))
write_csv(final_list,
"~/Box/ZamanianLab/Data/Genomics/AmineR/identification_pipeline/3/all_amineR.txt",
col_names = FALSE)
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30)
View(orthologs)
# pull the desired data
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
View(orthologs2)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct(transcript_id) %>%
arrange(transcript_id)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct(transcript_id, .keep_all = TRUE) %>%
arrange(transcript_id)
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = 'wbps_paralog_paralog_peptide_id') %>%
janitor::clean_names()
View(paralogs)
attributes = c('species_id_key',
'wbps_peptide_id',
'acviteprjeb1697_homolog_ensembl_peptide',
'anceylprjna72583_homolog_ensembl_peptide',
'assuumprjna62057_homolog_ensembl_peptide',
'brmalaprjna10729_homolog_ensembl_peptide',
'brpahaprjeb497_homolog_ensembl_peptide',
'brtimoprjeb4663_homolog_ensembl_peptide',
'buxyloprjea64437_homolog_ensembl_peptide',
'caelegprjna13758_homolog_ensembl_peptide',
'diimmiprjeb1797_homolog_ensembl_peptide',
'drmediprjeb500_homolog_ensembl_peptide',
'elelapprjeb502_homolog_ensembl_peptide',
'hacontprjeb506_homolog_ensembl_peptide',
'hepolyprjeb15396_homolog_ensembl_peptide',
'lisigmprjeb3075_homolog_ensembl_peptide',
'loloaprjna246086_homolog_ensembl_peptide',
'neamerprjna72135_homolog_ensembl_peptide',
'onflexprjna230512_homolog_ensembl_peptide',
'onocheprjeb1204_homolog_ensembl_peptide',
'onvolvprjeb513_homolog_ensembl_peptide',
'parediprjna186477_homolog_ensembl_peptide',
'paunivprjna386823_homolog_ensembl_peptide',
'patricprjeb515_homolog_ensembl_peptide',
'prpaciprjna12644_homolog_ensembl_peptide',
'stcarpprjna202318_homolog_ensembl_peptide',
'strattprjeb125_homolog_ensembl_peptide',
'tocaniprjna248777_homolog_ensembl_peptide',
'trspirprjna12603_homolog_ensembl_peptide',
'trmuriprjeb126_homolog_ensembl_peptide',
'wubancprjna275548_homolog_ensembl_peptide'
)
# pull the desired data
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names()
attributes = c('wbps_peptide_id',
'acviteprjeb1697_homolog_ensembl_peptide',
'anceylprjna72583_homolog_ensembl_peptide',
'assuumprjna62057_homolog_ensembl_peptide',
'brmalaprjna10729_homolog_ensembl_peptide',
'brpahaprjeb497_homolog_ensembl_peptide',
'brtimoprjeb4663_homolog_ensembl_peptide',
'buxyloprjea64437_homolog_ensembl_peptide',
'caelegprjna13758_homolog_ensembl_peptide',
'diimmiprjeb1797_homolog_ensembl_peptide',
'drmediprjeb500_homolog_ensembl_peptide',
'elelapprjeb502_homolog_ensembl_peptide',
'hacontprjeb506_homolog_ensembl_peptide',
'hepolyprjeb15396_homolog_ensembl_peptide',
'lisigmprjeb3075_homolog_ensembl_peptide',
'loloaprjna246086_homolog_ensembl_peptide',
'neamerprjna72135_homolog_ensembl_peptide',
'onflexprjna230512_homolog_ensembl_peptide',
'onocheprjeb1204_homolog_ensembl_peptide',
'onvolvprjeb513_homolog_ensembl_peptide',
'parediprjna186477_homolog_ensembl_peptide',
'paunivprjna386823_homolog_ensembl_peptide',
'patricprjeb515_homolog_ensembl_peptide',
'prpaciprjna12644_homolog_ensembl_peptide',
'stcarpprjna202318_homolog_ensembl_peptide',
'strattprjeb125_homolog_ensembl_peptide',
'tocaniprjna248777_homolog_ensembl_peptide',
'trspirprjna12603_homolog_ensembl_peptide',
'trmuriprjeb126_homolog_ensembl_peptide',
'wubancprjna275548_homolog_ensembl_peptide'
)
# pull the desired data
orthologs <- getBM(mart = mart,
filters = filters,
value = value,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct() %>%
arrange(transcript_id)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct(transcript_id, .keep_all = TRUE) %>%
arrange(transcript_id)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = 'wbps_paralog_paralog_peptide_id') %>%
janitor::clean_names()
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names()
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value)
# use the orthologs of Ce AmineRs as seeds for a new query
orthologs2 <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs$transcript_id,
attributes = attributes) %>%
janitor::clean_names() %>%
pivot_longer(cols = 1:30) %>%
dplyr::select(name, transcript_id = value) %>%
filter(transcript_id != '') %>%
distinct(transcript_id, .keep_all = TRUE) %>%
arrange(transcript_id)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = 'wbps_paralog_paralog_peptide_id') %>%
janitor::clean_names() %>%
dplyr::select(transcript_id = 1) %>%
distinct() %>%
arrange(transcript_id)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = c('species_id_key', 'wbps_paralog_paralog_peptide_id')) %>%
janitor::clean_names() %>%
dplyr::select(transcript_id = 1) %>%
distinct() %>%
arrange(transcript_id)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = c('species_id_key', 'wbps_paralog_paralog_peptide_id')) %>%
janitor::clean_names() %>%
dplyr::select(name, transcript_id = 2) %>%
distinct() %>%
arrange(transcript_id)
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = c('species_id_key', 'wbps_paralog_paralog_peptide_id')) %>%
janitor::clean_names()
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = c('species_id_key', 'wbps_paralog_paralog_peptide_id')) %>%
janitor::clean_names() %>%
dplyr::select(name = species_id_key, transcript_id = 2) %>%
distinct() %>%
arrange(transcript_id)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = c('species_id_key', 'wbps_paralog_paralog_peptide_id')) %>%
janitor::clean_names() %>%
dplyr::select(name = species_id_key, transcript_id = 2) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
arrange(transcript_id)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE)
# get the paralogs
paralogs <- getBM(mart = mart,
filters = 'wbps_peptide_id',
value = orthologs2$transcript_id,
attributes = c('species_id_key', 'wbps_paralog_paralog_peptide_id')) %>%
janitor::clean_names() %>%
dplyr::select(name = species_id_key, transcript_id = 2) %>%
filter(transcript_id != '') %>%
distinct(transcript_id, .keep_all = TRUE) %>%
arrange(transcript_id)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE)
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
mutate(species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name
))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
mutate(species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
mutate(species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
mutate(species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6),
species = case_when(
species == 'loloap' ~ 'loloa',
TRUE ~ species
))
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6),
species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6),
species = case_when(
)))))))))
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6),
species = case_when(
)))))))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
mutate(species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6),
species = case_when(
species == 'loloap' ~ 'loloa',
TRUE ~ species
))
final_list <- bind_rows(orthologs, orthologs2, paralogs) %>%
arrange(transcript_id) %>%
distinct(transcript_id, .keep_all = TRUE) %>%
mutate(species = case_when(
name == 'wbps_peptide_id' ~ 'ceelegprjna13758_homolog_ensembl_peptide',
TRUE ~ name),
species = str_remove(species, "_homolog_ensembl_peptide"),
species = str_sub(species, 1, 6),
species = case_when(
species == 'loloap' ~ 'loloa',
TRUE ~ species
)) %>%
mutate(transcript_id = case_when(
species %in% c('brmala', 'ceeleg') ~ str_remove(transcript_id, '\\.[0-9]$'),
TRUE ~ transcript_id
))
write_csv(final_list$transcript_id,
"~/Box/ZamanianLab/Data/Genomics/AmineR/identification_pipeline/3/all_amineR.txt",
col_names = FALSE)
write_csv(dplyr::select(final_list, transcript_id),
"~/Box/ZamanianLab/Data/Genomics/AmineR/identification_pipeline/3/all_amineR.txt",
col_names = FALSE)
